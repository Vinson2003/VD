@using VD.Helper;
@{
    ViewData["Title"] = "Profile";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="d-flex flex-column flex-column-fluid">
	<!--begin::Toolbar-->
	<div id="kt_app_toolbar" class="app-toolbar py-3 py-lg-6">
		<!--begin::Toolbar container-->
		<div id="kt_app_toolbar_container" class="app-container container-xxl d-flex flex-stack">
			<!--begin::Page title-->
			<div class="page-title d-flex flex-column justify-content-center flex-wrap me-3">
				<!--begin::Title-->
				<h1 class="page-heading d-flex text-dark fw-bold fs-3 flex-column justify-content-center my-0">Account Settings</h1>
				<!--end::Title-->
				<!--begin::Breadcrumb-->
				<ul class="breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0 pt-1">
					<!--begin::Item-->
					<li class="breadcrumb-item text-muted">
						<a href="../../demo1/dist/index.html" class="text-muted text-hover-primary">Home</a>
					</li>
					<!--end::Item-->
					<!--begin::Item-->
					<li class="breadcrumb-item">
						<span class="bullet bg-gray-400 w-5px h-2px"></span>
					</li>
					<!--end::Item-->
					<!--begin::Item-->
					<li class="breadcrumb-item text-muted">Account</li>
					<!--end::Item-->
				</ul>
				<!--end::Breadcrumb-->
			</div>
			<!--end::Page title-->
			<!--begin::Actions-->
			<div class="d-flex align-items-center gap-2 gap-lg-3">
				<!--brgin::Primary button-->
				<a href="#" class="btn btn-sm fw-bold btn-primary" data-bs-toggle="modal" data-bs-target="#kt_modal_create_app">Create</a>
				<!--end::Primary button-->
			</div>
			<!--end::Actions-->
		</div>
		<!--end::Toolbar container-->
	</div>
	<!--end::Toolbar-->
	<!--begin::Content-->
	<div id="kt_app_content" class="app-content flex-column-fluid">
		<!--begin::Content container-->
		<div id="kt_app_content_container" class="app-container container-xxl">
			<!--begin::Navbar-->
			<div class="card mb-5 mb-xl-10">
				<div class="card-body pt-9 pb-0">
					<!--begin::Details-->
					<div class="d-flex flex-wrap flex-sm-nowrap">
						<!--begin: Pic-->
						<div class="me-7 mb-4">
							<div class="symbol symbol-100px symbol-lg-160px symbol-fixed position-relative">
								<img src="~/img/Capybara.jpg" alt="image">
								<div class="position-absolute translate-middle bottom-0 start-100 mb-6 bg-success rounded-circle border border-4 border-body h-20px w-20px"></div>
							</div>
						</div>
						<!--end::Pic-->
						<!--begin::Info-->
						<div class="flex-grow-1">
							<!--begin::Title-->
							<div class="d-flex justify-content-between align-items-start flex-wrap mb-2">
								<!--begin::User-->
								<div class="d-flex flex-column">
									<!--begin::Name-->
									<div class="d-flex align-items-center mb-2">
										<a href="#" class="text-gray-900 text-hover-primary fs-2 fw-bold me-1">@User.GetUsername()</a>
										<a href="#">
											<i class="ki-duotone ki-verify fs-1 text-primary">
												<span class="path1"></span>
												<span class="path2"></span>
											</i>
										</a>
									</div>
									<!--end::Name-->
									<div class="d-flex flex-wrap fw-semibold fs-6 mb-4 pe-2">
										<a href="#" class="d-flex align-items-center text-gray-400 text-hover-primary me-5 mb-2">
											<i class="ki-duotone ki-profile-circle fs-4 me-1">
												<span class="path1"></span>
												<span class="path2"></span>
												<span class="path3"></span>
											</i>Admin
										</a>
										<a href="#" class="d-flex align-items-center text-gray-400 text-hover-primary mb-2">
											<i class="ki-duotone ki-sms fs-4">
												<span class="path1"></span>
												<span class="path2"></span>
											</i>vinsondeslian2018@gmail.com
										</a>
									</div>
								</div>
								<!--end::User-->
							</div>
							<!--end::Title-->
						</div>
						<!--end::Info-->
					</div>
					<!--end::Details-->
					<!--begin::Navs-->
					<ul class="nav nav-stretch nav-line-tabs nav-line-tabs-2x border-transparent fs-5 fw-bold">
						<!--begin::Nav item-->
						<li class="nav-item mt-2">
							<a class="nav-link text-active-primary ms-0 me-10 py-5 active" href="../../demo1/dist/account/settings.html">Settings</a>
						</li>
						<!--end::Nav item-->
						<!--begin::Nav item-->
						<li class="nav-item mt-2">
							<a class="nav-link text-active-primary ms-0 me-10 py-5" href="../../demo1/dist/account/security.html">Security</a>
						</li>
						<!--end::Nav item-->
					</ul>
					<!--begin::Navs-->
				</div>
			</div>
			<!--end::Navbar-->
			<!--begin::Basic info-->
			<div class="card mb-5 mb-xl-10">
				<!--begin::Card header-->
				<div class="card-header border-0 cursor-pointer" role="button" data-bs-toggle="collapse" data-bs-target="#kt_account_profile_details" aria-expanded="true" aria-controls="kt_account_profile_details">
					<!--begin::Card title-->
					<div class="card-title m-0">
						<h3 class="fw-bold m-0">Profile Details</h3>
					</div>
					<!--end::Card title-->
				</div>
				<!--begin::Content-->
				<div id="kt_account_settings_profile_details" class="collapse show">

					<!--begin::Form-->
					<form id="UpdateAccForm" class="form fv-plugins-bootstrap5 fv-plugins-framework" method="post" autocomplete="off">
						<!--begin::Card body-->
						<div class="card-body border-top p-9">
							<!--begin::Input group-->
							<div class="row mb-6">
								<!--begin::Label-->
								<label class="col-lg-4 col-form-label fw-semibold fs-6">Avatar</label>
								<!--end::Label-->
								<!--begin::Col-->
								<div class="col-lg-8">
									<!--begin::Image input-->
									<div class="image-input image-input-outline" data-kt-image-input="true" style="background-image: url('/img/Capybara.jpg')">
										<!--begin::Preview existing avatar-->
										<div class="image-input-wrapper w-125px h-125px" style="background-image: url(/img/Capybara.jpg)"></div>
										<!--end::Preview existing avatar-->
										<!--begin::Label-->
										<label class="btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow" data-kt-image-input-action="change" data-bs-toggle="tooltip" aria-label="Change avatar" data-bs-original-title="Change avatar" data-kt-initialized="1">
											<i class="ki-duotone ki-pencil fs-7">
												<span class="path1"></span>
												<span class="path2"></span>
											</i>
											<!--begin::Inputs-->
											<input type="file" name="avatar" accept=".png, .jpg, .jpeg">
											<input type="hidden" name="avatar_remove">
											<!--end::Inputs-->
										</label>
										<!--end::Label-->
										<!--begin::Cancel-->
										<span class="btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow" data-kt-image-input-action="cancel" data-bs-toggle="tooltip" aria-label="Cancel avatar" data-bs-original-title="Cancel avatar" data-kt-initialized="1">
											<i class="ki-duotone ki-cross fs-2">
												<span class="path1"></span>
												<span class="path2"></span>
											</i>
										</span>
										<!--end::Cancel-->
										<!--begin::Remove-->
										<span class="btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow" data-kt-image-input-action="remove" data-bs-toggle="tooltip" aria-label="Remove avatar" data-bs-original-title="Remove avatar" data-kt-initialized="1">
											<i class="ki-duotone ki-cross fs-2">
												<span class="path1"></span>
												<span class="path2"></span>
											</i>
										</span>
										<!--end::Remove-->
									</div>
									<!--end::Image input-->
									<!--begin::Hint-->
									<div class="form-text">Allowed file types: png, jpg, jpeg.</div>
									<!--end::Hint-->
								</div>
								<!--end::Col-->
							</div>
							<!--end::Input group-->

							<input type="hidden" class="form-control form-control-lg form-control-solid" id="ProfId" name="id" required>

							<div class="row mb-6">
								<label class="col-lg-4 col-form-label fw-semibold fs-6" for="ProfUsername">Username</label>
								<div class="col-lg-8">
									<div class="row">
										<div class="col-lg-12 fv-row fv-plugins-icon-container">
											<input type="text" name="username" id="ProfUsername" class="form-control form-control-lg form-control-solid mb-3 mb-lg-0" placeholder="Please insert Username" required>
											<div class="fv-plugins-message-container fv-plugins-message-container--enabled invalid-feedback"></div>
										</div>
									</div>
								</div>
							</div>

							<div class="row mb-6">
								<label class="col-lg-4 col-form-label fw-semibold fs-6" for="ProfPassword">Password</label>
								<div class="col-lg-8 fv-row fv-plugins-icon-container">
									<input type="password" name="password" id="ProfPassword" class="form-control form-control-lg form-control-solid" placeholder="Please insert Password" required>
									<div class="fv-plugins-message-container fv-plugins-message-container--enabled invalid-feedback"></div>
								</div>
							</div>

							<div class="row mb-6">
								<label class="col-lg-4 col-form-label fw-semibold fs-6" for="ConfirmPass">Confirm Password</label>
								<div class="col-lg-8 fv-row fv-plugins-icon-container">
									<input type="password" name="confirmpassword" id="ConfirmPass" class="form-control form-control-lg form-control-solid" placeholder="Please Insert Confirm Password" required>
									<div class="fv-plugins-message-container fv-plugins-message-container--enabled invalid-feedback"></div>
								</div>
							</div>

							<div class="row mb-6">
								<label class="col-lg-4 col-form-label fw-semibold fs-6" for="ProfEmail">Email</label>
								<div class="col-lg-8 fv-row">
									<input type="email" name="email" id="ProfEmail" class="form-control form-control-lg form-control-solid" placeholder="Please Insert Email" required>
								</div>
							</div>

							<div class="row mb-6">
								<label class="col-lg-4 col-form-label fw-semibold fs-6" for="ProfStatus">Status</label>
								<div class="col-lg-8 fv-row fv-plugins-icon-container">
									<select class="form-control form-control-lg form-control-solid" id="ProfStatus" name="status" data-kt-placeholder="Select a status..." required>
										<option selected disabled value="">Choose the status....</option>
										<option value="ENABLED">ENABLED</option>
										<option value="DISABLED">DISABLED</option>
									</select>
								</div>
							</div>

							<div class="row mb-6">
								<label class="col-lg-4 col-form-label fw-semibold fs-6" for="ProfRole">Role</label>
								<div class="col-lg-8 fv-row fv-plugins-icon-container">
									<select asp-items="@ViewBag.RoleList" id="ProfRole" name="RoleId" class="form-control form-control-lg form-control-solid" required>
										<option selected disabled value="">Choose the role....</option>
									</select>
								</div>
							</div>

							<div class="card-footer d-flex justify-content-end py-6 px-9">
								<button type="reset" class="btn btn-outline-light btn-active-light-primary me-2">Discard</button>
								<button type="submit" class="btn btn-outline-primary" onclick="submitAccForm()">Save Changes</button>
							</div>

							<input type="hidden">
						</div>
					</form>
					<!--end::Form-->
				</div>
				<!--end::Content-->
			</div>
			<!--end::Basic info-->
		</div>
		<!--end::Content container-->
	</div>
	<!--end::Content-->
</div>

@section Scripts {

	<script>
		function submitAccForm() {
			if (!$('#UpdateAccForm')[0].checkValidity()) {
				$("#UpdateAccForm")[0].reportValidity();
				return false;
			}

			Swal.fire({
				title: 'Are you sure?',
				icon: 'warning',
				showCancelButton: true,
				cancelButtonText: 'No',
				confirmButtonText: 'Yes'
			}).then((result) => {
				if (result.isConfirmed) {
					$.ajax({
						url: "@Url.Action("UpdateAccount", "Account")",
						data: $('#UpdateAccForm').serialize(),
						type: "POST",
						success: function (result) {
							if (result == true || result && result > 0) {
								Swal.fire(msg, '', 'success');
								reloadTable();
							}
							else if (typeof result === 'string') { Swal.fire(result, '', 'error'); }
							else if (result && result.length > 0) { Swal.fire(result[0], '', 'error'); }
							else { Swal.fire('', '', 'error'); }
						},
					});
				}
			});
		}
	</script>
}